Parameters:
  DashboardDataSetIdentifier01:
    Description: TODO
    Type: String
  DashboardId01:
    Description: TODO
    Type: String
  DashboardName01:
    Description: TODO
    Type: String
  DataSetAthenaCatalog01:
    Description: Catalog for DataSetAthenaCatalog01, e.g., 'AwsDataCatalog'
    Type: String
  DataSetAthenaId01:
    Description: ID for DataSetAthenaId01, e.g., '2384dd87-5baa-4308-b2e4-1ec602bba012'
    Type: String
  DataSetAthenaName01:
    Description: Name for DataSetAthenaName01, e.g., 'athenatesttable'
    Type: String
  DataSetAthenaSchema01:
    Description: Schema for DataSetAthenaSchema01, e.g., 'athenatestdatabase'
    Type: String
  DataSetAthenaTableName01:
    Description: TableName for DataSetAthenaTableName01, e.g., 'athenatesttable'
    Type: String
  DataSourceAthenaWorkGroup01:
    Default: primary
    Description: Athena Workgroup for the Data Source
    Type: String
  DataSourceId01:
    Description: ID of Athena Data Source
    Type: String
  DataSourceName01:
    Description: Name of the Data Source
    Type: String
  QuickSightNamespace:
    Default: default
    Description: Namespace for the ARN
    Type: String
  QuickSightPrincipalType:
    Default: user
    Description: Principal type for the ARN
    Type: String
  QuickSightUsername:
    Default: master
    Description: Username with QuickSight permissions
    Type: String
Resources:
  AthenaDataSetTable01:
    Metadata:
      aws:cdk:path: QsStack/AthenaDataSetTable01
    Properties:
      AwsAccountId:
        Ref: AWS::AccountId
      DataSetId:
        Ref: DataSetAthenaId01
      DataSetUsageConfiguration:
        DisableUseAsDirectQuerySource: false
        DisableUseAsImportedSource: false
      ImportMode: SPICE
      LogicalTableMap:
        491e3d47-ac11-4d5b-ac15-a543486ac7d9:
          Alias:
            Ref: DataSetAthenaTableName01
          Source:
            PhysicalTableId: 2bdc47b0-8132-42bb-8eb7-8686f6ef53ff
      Name:
        Ref: DataSetAthenaName01
      Permissions:
      - Actions:
        - quicksight:DeleteDataSet
        - quicksight:UpdateDataSetPermissions
        - quicksight:PutDataSetRefreshProperties
        - quicksight:CreateRefreshSchedule
        - quicksight:CancelIngestion
        - quicksight:ListRefreshSchedules
        - quicksight:UpdateRefreshSchedule
        - quicksight:PassDataSet
        - quicksight:DeleteRefreshSchedule
        - quicksight:DescribeDataSetRefreshProperties
        - quicksight:DescribeDataSet
        - quicksight:CreateIngestion
        - quicksight:DescribeRefreshSchedule
        - quicksight:ListIngestions
        - quicksight:UpdateDataSet
        - quicksight:DescribeDataSetPermissions
        - quicksight:DeleteDataSetRefreshProperties
        - quicksight:DescribeIngestion
        Principal:
          Fn::Sub:
          - arn:aws:quicksight:${aws_region}:${aws_account}:${principal_type}/${namespace}/${username}
          - aws_account:
              Ref: AWS::AccountId
            aws_region:
              Ref: AWS::Region
            namespace:
              Ref: QuickSightNamespace
            principal_type:
              Ref: QuickSightPrincipalType
            username:
              Ref: QuickSightUsername
      PhysicalTableMap:
        2bdc47b0-8132-42bb-8eb7-8686f6ef53ff:
          RelationalTable:
            Catalog: AwsDataCatalog
            DataSourceArn:
              Fn::GetAtt:
              - AthenaDataSource01
              - Arn
            InputColumns:
            - Name: id
              Type: INTEGER
            - Name: name
              Type: STRING
            - Name: age
              Type: INTEGER
            - Name: score
              Type: DECIMAL
            Name:
              Ref: DataSetAthenaTableName01
            Schema:
              Ref: DataSetAthenaSchema01
    Type: AWS::QuickSight::DataSet
  AthenaDataSource01:
    Metadata:
      aws:cdk:path: QsStack/AthenaDataSource01
    Properties:
      AwsAccountId:
        Ref: AWS::AccountId
      DataSourceId:
        Ref: DataSourceId01
      DataSourceParameters:
        AthenaParameters:
          WorkGroup:
            Ref: DataSourceAthenaWorkGroup01
      Name:
        Ref: DataSourceName01
      Permissions:
      - Actions:
        - quicksight:DescribeDataSource
        - quicksight:DescribeDataSourcePermissions
        - quicksight:PassDataSource
        - quicksight:UpdateDataSource
        - quicksight:DeleteDataSource
        - quicksight:UpdateDataSourcePermissions
        Principal:
          Fn::Sub:
          - arn:aws:quicksight:${aws_region}:${aws_account}:${principalType}/${qsNamespace}/${user}
          - aws_account:
              Ref: AWS::AccountId
            aws_region:
              Ref: AWS::Region
            principalType:
              Ref: QuickSightPrincipalType
            qsNamespace:
              Ref: QuickSightNamespace
            user:
              Ref: QuickSightUsername
      SslProperties:
        DisableSsl: false
      Type: ATHENA
    Type: AWS::QuickSight::DataSource
  QuickSightDashboard01:
    Metadata:
      aws:cdk:path: QsStack/QuickSightDashboard01
    Properties:
      AwsAccountId:
        Ref: AWS::AccountId
      DashboardId:
        Ref: DashboardId01
      Definition:
        AnalysisDefaults:
          DefaultNewSheetConfiguration:
            InteractiveLayoutConfiguration:
              Grid:
                CanvasSizeOptions:
                  ScreenCanvasSizeOptions:
                    OptimizedViewPortWidth: 1600px
                    ResizeOption: FIXED
            SheetContentType: INTERACTIVE
        CalculatedFields: []
        DataSetIdentifierDeclarations:
        - DataSetArn:
            Fn::GetAtt:
            - AthenaDataSetTable01
            - Arn
          Identifier:
            Ref: DashboardDataSetIdentifier01
        FilterGroups: []
        ParameterDeclarations: []
        Sheets:
        - ContentType: INTERACTIVE
          Layouts:
          - Configuration:
              GridLayout:
                CanvasSizeOptions:
                  ScreenCanvasSizeOptions:
                    OptimizedViewPortWidth: 1600px
                    ResizeOption: FIXED
                Elements:
                - ColumnSpan: 18
                  ElementId: 2ed4d134-af38-461d-ab2e-6853684a92b4_5ddf5aa4-dc64-4e52-b0a7-fc3a7f98ac76
                  ElementType: VISUAL
                  RowSpan: 12
          Name: Sheet 1
          SheetId: 2ed4d134-af38-461d-ab2e-6853684a92b4_c8befdca-95c2-473b-86af-0519b1f0af2c
          Visuals:
          - PivotTableVisual:
              Actions: []
              ChartConfiguration:
                FieldOptions:
                  SelectedFieldOptions:
                  - FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.name.3.1705373376044
                    Visibility: VISIBLE
                  - FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.id.0.1705373376044
                    Visibility: VISIBLE
                  - FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.age.1.1705373376044
                    Visibility: VISIBLE
                  - FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.score.2.1705373376044
                    Visibility: VISIBLE
                FieldWells:
                  PivotTableAggregatedFieldWells:
                    Columns:
                    - NumericalDimensionField:
                        Column:
                          ColumnName: id
                          DataSetIdentifier:
                            Ref: DashboardDataSetIdentifier01
                        FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.id.0.1705373376044
                    Rows:
                    - CategoricalDimensionField:
                        Column:
                          ColumnName: name
                          DataSetIdentifier:
                            Ref: DashboardDataSetIdentifier01
                        FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.name.3.1705373376044
                    Values:
                    - NumericalMeasureField:
                        AggregationFunction:
                          SimpleNumericalAggregation: SUM
                        Column:
                          ColumnName: age
                          DataSetIdentifier:
                            Ref: DashboardDataSetIdentifier01
                        FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.age.1.1705373376044
                    - NumericalMeasureField:
                        AggregationFunction:
                          SimpleNumericalAggregation: SUM
                        Column:
                          ColumnName: score
                          DataSetIdentifier:
                            Ref: DashboardDataSetIdentifier01
                        FieldId: 491e3d47-ac11-4d5b-ac15-a543486ac7d9.score.2.1705373376044
                SortConfiguration:
                  FieldSortOptions: []
                TableOptions:
                  CellStyle: {}
                  CollapsedRowDimensionsVisibility: HIDDEN
                  ColumnHeaderStyle: {}
                  RowAlternateColorOptions:
                    Status: DISABLED
                    UsePrimaryBackgroundColor: ENABLED
                  RowsLayout: HIERARCHY
                TotalOptions:
                  ColumnTotalOptions:
                    Placement: END
                  RowSubtotalOptions:
                    CustomLabel: <<$aws:subtotalDimension>> Subtotal
                    MetricHeaderCellStyle: {}
                    StyleTargets:
                    - CellType: VALUE
                    - CellType: TOTAL
                    - CellType: METRIC_HEADER
                    TotalCellStyle: {}
                    TotalsVisibility: VISIBLE
                    ValueCellStyle: {}
                  RowTotalOptions:
                    Placement: AUTO
              Subtitle:
                Visibility: VISIBLE
              Title:
                Visibility: VISIBLE
              VisualId: 2ed4d134-af38-461d-ab2e-6853684a92b4_5ddf5aa4-dc64-4e52-b0a7-fc3a7f98ac76
      Name:
        Ref: DashboardName01
      Permissions:
      - Actions:
        - quicksight:DescribeDashboard
        - quicksight:ListDashboardVersions
        - quicksight:UpdateDashboardPermissions
        - quicksight:QueryDashboard
        - quicksight:UpdateDashboard
        - quicksight:DeleteDashboard
        - quicksight:DescribeDashboardPermissions
        - quicksight:UpdateDashboardPublishedVersion
        Principal:
          Fn::Sub:
          - arn:aws:quicksight:${aws_region}:${aws_account}:${principal_type}/${namespace}/${username}
          - aws_account:
              Ref: AWS::AccountId
            aws_region:
              Ref: AWS::Region
            namespace:
              Ref: QuickSightNamespace
            principal_type:
              Ref: QuickSightPrincipalType
            username:
              Ref: QuickSightUsername
    Type: AWS::QuickSight::Dashboard
